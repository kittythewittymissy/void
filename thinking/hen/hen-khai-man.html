<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hèn: Khai màn</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Neonderthaw&family=Codystar:wght@300;400;500&family=Raleway+Dots&family=Raleway&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../style.css">
</head>
<body>

  <!-- HUGE BACKGROUND SERIES NAME -->
  <div class="series-background check-vietnamese">Hèn</div>

  <!-- FLEX ROW: SPINE + CONTENT -->
  <div class="main-row">
    <!-- LEFT COLUMN / SPINE TITLE -->
    <div class="work-title" style="padding-top:1cm; padding-left:1cm;">
      <h1 class="check-vietnamese">Hèn: Khai màn</h1>
      <!-- Optional gold divider can go here with ::after on specific pages -->
    </div>

    <!-- CENTERED CONTENT -->
    <div class="work-content">
      <div class="text-section">
        <p class="floating-paragraph">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed a luctus nibh. Suspendisse potenti.</p>
        <p class="floating-paragraph">Praesent vitae enim a justo pretium tincidunt. Fusce vel lacus vitae ligula tempus sodales.</p>
        <p class="floating-paragraph">Curabitur nec justo vitae lacus finibus posuere. Integer vel nibh sed magna sollicitudin fermentum.</p>
      </div>

      <!-- NEXT PART ARROW -->
      <a href="#next-part" class="next-part" id="nextArrow">⌄</a>
    </div>
  </div>

  <!-- AUDIO BUTTON WITH ORBITING TEXT (optional per page) -->
  <div class="audio-button-container">
    <button class="audio-button" id="audioButton">
      <svg viewBox="0 0 24 24">
        <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.74 2.5-2.26 2.5-4.02zM14 3.23v2.06c2.89 1.1 5 3.92 5 7.21s-2.11 6.11-5 7.21v2.06c4.01-1.21 7-5.04 7-9.27s-2.99-8.06-7-9.27z"/>
      </svg>
    </button>
    <div class="orbiting-text" id="orbitText"></div>
  </div>

  <script>
    // FONT FALLBACK
    function applyFontFallback() {
      document.querySelectorAll('.check-vietnamese').forEach(el => {
        if (/[ăâđêôơư]/i.test(el.textContent)) el.style.fontFamily = "'Raleway', sans-serif";
      });
    }
    window.addEventListener('load', applyFontFallback);

    // PARTICLES
    for(let i=0;i<40;i++){
      const p = document.createElement('div');
      p.className = 'particle';
      const size = Math.random()*4+1;
      p.style.width = p.style.height = size+'px';
      p.style.left = Math.random()*100+'vw';
      p.style.animationDuration = 15+Math.random()*20+'s';
      p.style.opacity = Math.random()*0.3 + 0.05;
      p.style.position = 'absolute';
      p.style.background = 'rgba(255,255,255,0.05)';
      p.style.borderRadius = '50%';
      p.style.zIndex = '0';
      document.body.appendChild(p);
    }

    // AUDIO BUTTON
    document.getElementById('audioButton').addEventListener('click', () => {
      alert('Audio button clicked! Replace with Spotify embed or audio playback.');
    });

    // ORBITING LETTERS
    const orbitText = document.getElementById('orbitText');
    const text = "Let me read to you";
    for(let i=0;i<text.length;i++){
      const span = document.createElement('span');
      span.textContent = text[i];
      const angle = i * (360 / text.length);
      span.style.transform = `rotate(${angle}deg) translateX(50px) rotate(${-angle}deg)`;
      span.style.animationDuration = `${4 + Math.random()*2}s`;
      orbitText.appendChild(span);
    }

    // NEXT PART FUNCTION + TYPEWRITER
    const typewriterFade = (el, txt, delay=0) => {
      el.style.opacity=0; el.textContent='';
      let i=0;
      function step(){
        if(i<txt.length){
          el.textContent+=txt[i];
          el.style.opacity = 0.7+Math.random()*0.3;
          i++;
          setTimeout(step, 40+Math.random()*20);
        } else { el.style.opacity=1; }
      }
      setTimeout(step, delay);
    };

    document.getElementById('nextArrow').addEventListener('click', e=>{
      e.preventDefault();
      const heading = document.querySelector('.work-title h1');
      heading.style.opacity = 0;
      setTimeout(()=>{
        heading.textContent="Hèn: Part 2";
        heading.style.animation='fadeInTitle 1.5s forwards';
        applyFontFallback();
      },300);

      const textSection = document.querySelector('.text-section');
      const nextParagraphs = [
        "Next part first paragraph goes here.",
        "Next part second paragraph goes here.",
        "Next part third paragraph goes here."
      ];
      textSection.innerHTML = '';
      nextParagraphs.forEach((p,i)=>{
        const para=document.createElement('p');
        para.className='floating-paragraph';
        textSection.appendChild(para);
        typewriterFade(para,p,50+i*30);
      });
      textSection.scrollIntoView({behavior:'smooth'});
    });

    // RECURRING SCROLL ANIMATION
    const workTitle = document.querySelector('.work-title h1');
    const content = document.querySelector('.work-content');

    // initial flash on page load
    window.addEventListener('load', ()=>{
      workTitle.style.animation='fadeInTitle 1s forwards';
    });

    const observer = new IntersectionObserver(entries=>{
      entries.forEach(entry=>{
        if(entry.isIntersecting){
          // title flash
          workTitle.style.animation='fadeInTitle 0.5s forwards';
          // body mild pop
          document.querySelectorAll('.floating-paragraph').forEach(p=>{
            p.classList.remove('floating-pop'); void p.offsetWidth;
            p.classList.add('floating-pop');
          });
        }
      });
    }, {threshold:0.5});
    observer.observe(content);
  </script>
</body>
</html>
